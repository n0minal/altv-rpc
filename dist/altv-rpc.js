'use strict';Object.defineProperty(exports,"__esModule",{value:!0});var alt=require("alt");function _interopDefaultLegacy(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var Reflect$1,alt__default=_interopDefaultLegacy(alt);(function(e){(function(t){function n(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}var r="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),a=n(e);"undefined"==typeof r.Reflect?r.Reflect=e:a=n(r.Reflect,a),t(a)})(function(e){function t(e,t){for(var n=e.length-1;0<=n;--n){var r=e[n],a=r(t);if(!g(a)&&!u(a)){if(!E(a))throw new TypeError;t=a}}return t}function n(e,t,n,r){for(var a=e.length-1;0<=a;--a){var o=e[a],l=o(t,n,r);if(!g(l)&&!u(l)){if(!y(l))throw new TypeError;r=l}}return r}function r(e,t,n){var r=F.get(e);if(g(r)){if(!n)return;r=new L,F.set(e,r)}var a=r.get(t);if(g(a)){if(!n)return;a=new L,r.set(t,a)}return a}function a(e,t,n){var r=o(e,t,n);if(r)return!0;var l=j(t);return!u(l)&&a(e,l,n)}function o(e,t,n){var a=r(t,n,!1);return!g(a)&&h(a.has(e))}function l(e,t,n){var r=o(e,t,n);if(r)return i(e,t,n);var a=j(t);return u(a)?void 0:l(e,a,n)}function i(e,t,n){var a=r(t,n,!1);return g(a)?void 0:a.get(e)}function s(e,t,n,a){var o=r(n,a,!0);o.set(e,t)}function d(e,t){var n=c(e,t),r=j(e);if(null===r)return n;var a=d(r,t);if(0>=a.length)return n;if(0>=n.length)return a;for(var o=new D,l=[],i=0,s=n;i<s.length;i++){var p=s[i],g=o.has(p);g||(o.add(p),l.push(p))}for(var u=0,f=a;u<f.length;u++){var p=f[u],g=o.has(p);g||(o.add(p),l.push(p))}return l}function c(e,t){var n=[],a=r(e,t,!1);if(g(a))return n;for(var o=a.keys(),l=w(o),i=0;;){var s=P(l);if(!s)return n.length=i,n;var d=O(s);try{n[i]=d}catch(t){try{C(l)}finally{throw t}}i++}}function p(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6;}}function g(e){return e===void 0}function u(e){return null===e}function f(e){return"symbol"==typeof e}function y(e){return"object"==typeof e?null!==e:"function"==typeof e}function _(e,t){switch(p(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e;}var n=3===t?"string":5===t?"number":"default",r=k(e,T);if(r!==void 0){var a=r.call(e,n);if(y(a))throw new TypeError;return a}return m(e,"default"==n?"number":n)}function m(e,t){if("string"===t){var n=e.toString;if(b(n)){var r=n.call(e);if(!y(r))return r}var a=e.valueOf;if(b(a)){var r=a.call(e);if(!y(r))return r}}else{var a=e.valueOf;if(b(a)){var r=a.call(e);if(!y(r))return r}var o=e.toString;if(b(o)){var r=o.call(e);if(!y(r))return r}}throw new TypeError}function h(e){return!!e}function v(e){return""+e}function R(e){var t=_(e,3);return f(t)?t:v(t)}function S(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function b(e){return"function"==typeof e}function E(e){return"function"==typeof e}function x(e){switch(p(e)){case 3:return!0;case 4:return!0;default:return!1;}}function k(e,t){var n=e[t];if(void 0!==n&&null!==n){if(!b(n))throw new TypeError;return n}}function w(e){var t=k(e,I);if(!b(t))throw new TypeError;var n=t.call(e);if(!y(n))throw new TypeError;return n}function O(e){return e.value}function P(e){var t=e.next();return!t.done&&t}function C(e){var t=e["return"];t&&t.call(e)}function j(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===V)return t;if(t!==V)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var a=r.constructor;return"function"==typeof a?a===e?t:a:t}function B(e){return e.__=void 0,delete e.__,e}var M=Object.prototype.hasOwnProperty,U="function"==typeof Symbol,T=U&&"undefined"!=typeof Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",I=U&&"undefined"!=typeof Symbol.iterator?Symbol.iterator:"@@iterator",A="function"==typeof Object.create,N={__proto__:[]}instanceof Array,K=!A&&!N,Q={create:A?function(){return B(Object.create(null))}:N?function(){return B({__proto__:null})}:function(){return B({})},has:K?function(e,t){return M.call(e,t)}:function(e,t){return t in e},get:K?function(e,t){return M.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},V=Object.getPrototypeOf(Function),z="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,L=z||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){function e(e){return e}function t(e,t){return t}function n(e,t){return[e,t]}var r={},a=[],o=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[I]=function(){return this},e.prototype.next=function(){var e=this._index;if(0<=e&&e<this._keys.length){var t=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=a,this._values=a):this._index++,{value:t,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw 0<=this._index&&(this._index=-1,this._keys=a,this._values=a),e},e.prototype.return=function(e){return 0<=this._index&&(this._index=-1,this._keys=a,this._values=a),{value:e,done:!0}},e}();return function(){function a(){this._keys=[],this._values=[],this._cacheKey=r,this._cacheIndex=-2}return Object.defineProperty(a.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),a.prototype.has=function(e){return 0<=this._find(e,!1)},a.prototype.get=function(e){var t=this._find(e,!1);return 0<=t?this._values[t]:void 0},a.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},a.prototype.delete=function(e){var t=this._find(e,!1);if(0<=t){for(var n=this._keys.length,a=t+1;a<n;a++)this._keys[a-1]=this._keys[a],this._values[a-1]=this._values[a];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=r,this._cacheIndex=-2),!0}return!1},a.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=r,this._cacheIndex=-2},a.prototype.keys=function(){return new o(this._keys,this._values,e)},a.prototype.values=function(){return new o(this._keys,this._values,t)},a.prototype.entries=function(){return new o(this._keys,this._values,n)},a.prototype["@@iterator"]=function(){return this.entries()},a.prototype[I]=function(){return this.entries()},a.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),0>this._cacheIndex&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},a}()}():Map,D=z||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){return function(){function e(){this._map=new L}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[I]=function(){return this.keys()},e}()}():Set,W=z||"function"!=typeof WeakMap?function(){function e(){var e;do e="@@WeakMap@@"+a();while(Q.has(o,e));return o[e]=!0,e}function t(e,t){if(!M.call(e,l)){if(!t)return;Object.defineProperty(e,l,{value:Q.create()})}return e[l]}function n(e,t){for(var n=0;n<t;++n)e[n]=0|255*Math.random();return e}function r(e){return"function"==typeof Uint8Array?"undefined"==typeof crypto?"undefined"==typeof msCrypto?n(new Uint8Array(e),e):msCrypto.getRandomValues(new Uint8Array(e)):crypto.getRandomValues(new Uint8Array(e)):n(Array(e),e)}function a(){var e=r(16);e[6]=64|79&e[6],e[8]=128|191&e[8];for(var t,n="",a=0;a<16;++a)t=e[a],(4==a||6===a||8===a)&&(n+="-"),16>t&&(n+="0"),n+=t.toString(16).toLowerCase();return n}var o=Q.create(),l=e();return function(){function n(){this._key=e()}return n.prototype.has=function(e){var n=t(e,!1);return void 0!==n&&Q.has(n,this._key)},n.prototype.get=function(e){var n=t(e,!1);return void 0===n?void 0:Q.get(n,this._key)},n.prototype.set=function(e,n){var r=t(e,!0);return r[this._key]=n,this},n.prototype.delete=function(e){var n=t(e,!1);return void 0!==n&&delete n[this._key]},n.prototype.clear=function(){this._key=e()},n}()}():WeakMap,F=new W;e("decorate",function(e,r,a,o){if(!g(a)){if(!S(e))throw new TypeError;if(!y(r))throw new TypeError;if(!y(o)&&!g(o)&&!u(o))throw new TypeError;return u(o)&&(o=void 0),a=R(a),n(e,r,a,o)}if(!S(e))throw new TypeError;if(!E(r))throw new TypeError;return t(e,r)}),e("metadata",function(e,t){return function(n,r){if(!y(n))throw new TypeError;if(!g(r)&&!x(r))throw new TypeError;s(e,t,n,r)}}),e("defineMetadata",function(e,t,n,r){if(!y(n))throw new TypeError;return g(r)||(r=R(r)),s(e,t,n,r)}),e("hasMetadata",function(e,t,n){if(!y(t))throw new TypeError;return g(n)||(n=R(n)),a(e,t,n)}),e("hasOwnMetadata",function(e,t,n){if(!y(t))throw new TypeError;return g(n)||(n=R(n)),o(e,t,n)}),e("getMetadata",function(e,t,n){if(!y(t))throw new TypeError;return g(n)||(n=R(n)),l(e,t,n)}),e("getOwnMetadata",function(e,t,n){if(!y(t))throw new TypeError;return g(n)||(n=R(n)),i(e,t,n)}),e("getMetadataKeys",function(e,t){if(!y(e))throw new TypeError;return g(t)||(t=R(t)),d(e,t)}),e("getOwnMetadataKeys",function(e,t){if(!y(e))throw new TypeError;return g(t)||(t=R(t)),c(e,t)}),e("deleteMetadata",function(e,t,n){if(!y(t))throw new TypeError;g(n)||(n=R(n));var a=r(t,n,!1);if(g(a))return!1;if(!a.delete(e))return!1;if(0<a.size)return!0;var o=F.get(t);return!(o.delete(n),!(0<o.size))||(F.delete(t),!0)})})})(Reflect$1||(Reflect$1={}));const glob=getGlobal(),setTimeout=alt__default["default"].setTimeout||glob.setTimeout;function uid(){const e=0|46656*Math.random(),t=0|46656*Math.random(),n=("000"+e.toString(36)).slice(-3),r=("000"+t.toString(36)).slice(-3);return n+r}function getEnvironment(){if(!alt__default["default"].Player)return"cef";return alt__default["default"].Player.local?"client":alt__default["default"].Player?"server":void 0}function stringifyData(e){const t=getEnvironment();return JSON.stringify(e,(e,n)=>("client"===t||"server"===t)&&n instanceof alt__default["default"].Entity?{__i:n.id}:n)}function parseData(t){const n=getEnvironment();try{return JSON.parse(t,(e,t)=>("client"===n||"server"===n)&&t&&"object"==typeof t&&"number"==typeof t.__i&&1===Object.keys(t).length?alt__default["default"].Entity.getByID(t.__i):t)}catch(n){log(`Failed to parse event arguments: ${n.message}`,!0),log(t,!0)}}function promiseTimeout(e,t){return"number"==typeof t?Promise.race([new Promise((e,n)=>{setTimeout(()=>n("TIMEOUT"),t)}),e]):e}function getGlobal(){if("undefined"!=typeof global)return global;return"undefined"==typeof window?void 0:window}function requestNamespace(e){const t="__rpc:namespaces",n=(e,t)=>{if(!e.includes(t))return e.push(t),!0};if(glob){const r=glob[t]||[];if(!n(r,e))return!1;glob[t]=r}else{const r=alt__default["default"].Player.local;if(r){const a=r.getMeta(t),o=a?JSON.parse(a):[];if(!n(o,e))return!1;r.setMeta(t,JSON.stringify(o))}}return!0}function log(e,t=!1){const n=getEnvironment();(t||!1)&&(alt__default["default"].log||console.log)(`RPC (${n}): ${e}`)}function chunk(e){return e.match(/.{1,10000}/g)}const environment=getEnvironment();if(!environment)throw"Unknown alt:V environment";const ERR_NOT_FOUND="PROCEDURE_NOT_FOUND",PROCESS_EVENT="__rpc:process",BROWSER_REGISTER="__rpc:browserRegister",TRIGGER_EVENT="__rpc:triggerEvent",TRIGGER_EVENT_BROWSERS="__rpc:triggerEventBrowsers";var EventType;(function(e){e[e.REQUEST=0]="REQUEST",e[e.RESPONSE_SUCCESS=1]="RESPONSE_SUCCESS",e[e.RESPONSE_ERROR=2]="RESPONSE_ERROR"})(EventType||(EventType={}));const rpcListeners={},rpcPending={},rpcIncoming={},rpcEvListeners={},rpcBrowsers=[],rpcBrowserProcedures={},registeredProcedures=new Map;let rpcNamespace="";function init(e){if(rpcNamespace)throw"Already initialized.";if(!e)throw"Must specify a namespace.";if(!requestNamespace(e))throw`Namespace "${e}" is already in use.`;log(`Initialized with namespace "${e}"`),rpcNamespace=e;const t=getEventName(PROCESS_EVENT),n=getEventName(TRIGGER_EVENT);alt__default["default"].on(t,processEvent),"server"===environment&&alt__default["default"].onClient(t,(e,t)=>processEvent(t,e)),"client"===environment&&(alt__default["default"].onServer(t,processEvent),register("__rpc:callServer",([e,t,n],r)=>_callServer(e,t,{fenv:r.environment,noRet:n})),register("__rpc:callBrowsers",([e,t,n],r)=>_callBrowsers(null,e,t,{fenv:r.environment,noRet:n})),register(getEventName(TRIGGER_EVENT_BROWSERS),([e,t],r)=>{rpcBrowsers.forEach(a=>{_callBrowser(a,n,[e,t],{fenv:r.environment,noRet:1})})})),register(n,([e,t],n)=>callEvent(e,t,n))}function getEventName(e){return`${e}::${rpcNamespace}`}function requireNamespace(){if(!rpcNamespace)throw new Error(`You must first call rpc.init() with a namespace.`)}function processEvent(e,t,n){log(`Processing Event: ${e.id} (${e.part}/${e.total})${t?" from player":""}${n?" from cef":""}`);const r=rpcIncoming[e.id]||{recv:0,total:e.total};if("undefined"!=typeof e.args&&(!r.args&&(r.args=""),r.args+=e.args),r.recv++,rpcIncoming[e.id]=r,r.recv<r.total)return;delete rpcIncoming[e.id],log(`Stringified Args: ${r.args}`);const a="undefined"==typeof r.args?void 0:parseData(r.args),o=getEventName(PROCESS_EVENT);if(e.type===EventType.REQUEST){const r={id:e.id,environment:e.fenv||e.env,player:t};let l,i=!0;switch(environment){case"server":l=e=>alt__default["default"].emitClient(t,o,e);break;case"client":{"server"===e.env?l=e=>alt__default["default"].emitServer(o,e):"cef"===e.env&&(r.browser=n,l=e=>n&&n.valid&&n.emit(o,e));break}case"cef":l=e=>alt__default["default"].emit(PROCESS_EVENT,e),i=!1;}if(l){const t=callProcedure(e.name,a,r);if(!e.noRet){let n,r=EventType.RESPONSE_SUCCESS;t.then(e=>{n=e}).catch(e=>{r=EventType.RESPONSE_ERROR,n=e}).finally(()=>{sendEvent({type:r,id:e.id,env:environment},n,l,i)})}}}else{const n=rpcPending[e.id];if("server"===environment&&n.player!==t)return;n&&(n.resolve(e.type===EventType.RESPONSE_SUCCESS?a:Promise.reject(a)),delete rpcPending[e.id])}}async function callProcedure(e,t,n){const r=rpcListeners[e];if(!r)throw ERR_NOT_FOUND;return r(t,n)}function sendEvent(e,t,n,r=!0){const a=(t,r,a)=>n({...e,part:t,total:r,args:a});if("undefined"!=typeof t){const e=stringifyData(t),n=r?chunk(e):[e];n.forEach((e,t)=>{a(t+1,n.length,e)})}else a(1,1)}function addWebView(e){if(requireNamespace(),"client"!==environment)throw"addWebView can only be used on the client";rpcBrowsers.includes(e)||(e.on(PROCESS_EVENT,t=>processEvent(t,void 0,e)),e.on(BROWSER_REGISTER,t=>{rpcBrowserProcedures[t]=e}),rpcBrowsers.push(e))}function register(e,t){if(2!==arguments.length)throw"register expects 2 arguments: \"name\" and \"cb\"";log(`Registered procedure "${e}"`),"cef"===environment&&alt__default["default"].emit(BROWSER_REGISTER,e),rpcListeners[e]=t}function unregister(e){if(1!==arguments.length)throw"unregister expects 1 argument: \"name\"";rpcListeners[e]=void 0}function call(e,t,n={}){return 1>arguments.length||3<arguments.length?Promise.reject("call expects 1 to 3 arguments: \"name\", optional \"args\", and optional \"options\""):promiseTimeout(callProcedure(e,t,{environment}),n.timeout)}function _callServer(e,t,n={}){switch(requireNamespace(),environment){case"server":return call(e,t);case"client":{const r=uid();return new Promise(a=>{n.noRet||(rpcPending[r]={resolve:a}),sendEvent({type:EventType.REQUEST,id:r,name:e,env:environment,...n},t,e=>alt__default["default"].emitServer(getEventName(PROCESS_EVENT),e))})}case"cef":return callClient("__rpc:callServer",[e,t,+n.noRet]);}}function callServer(e,t,n={}){if(requireNamespace(),1>arguments.length||3<arguments.length)return Promise.reject("callServer expects 1 to 3 arguments: \"name\", optional \"args\", and optional \"options\"");let r={};return n.noRet&&(r.noRet=1),promiseTimeout(_callServer(e,t,r),n.timeout)}function _callClient(e,t,n,r={}){switch(requireNamespace(),environment){case"client":return call(t,n);case"server":{const a=uid();return new Promise(o=>{r.noRet||(rpcPending[a]={resolve:o,player:e}),sendEvent({type:EventType.REQUEST,id:a,name:t,env:environment,...r},n,t=>alt__default["default"].emitClient(e,getEventName(PROCESS_EVENT),t))})}case"cef":{const e=uid();return new Promise(a=>{r.noRet||(rpcPending[e]={resolve:a}),sendEvent({type:EventType.REQUEST,id:e,name:t,env:environment,...r},n,e=>alt__default["default"].emit(PROCESS_EVENT,e),!1)})}}}function callClient(e,t,n,r={}){switch(requireNamespace(),environment){case"client":{if(r=n||{},n=t,t=e,e=null,1>arguments.length||3<arguments.length||"string"!=typeof t)return Promise.reject("callClient from the client expects 1 to 3 arguments: \"name\", optional \"args\", and optional \"options\"");break}case"server":{if(2>arguments.length||4<arguments.length||"object"!=typeof e)return Promise.reject("callClient from the server expects 2 to 4 arguments: \"player\", \"name\", optional \"args\", and optional \"options\"");break}case"cef":{if(r=n||{},n=t,t=e,e=null,1>arguments.length||3<arguments.length||"string"!=typeof t)return Promise.reject("callClient from the browser expects 1 to 3 arguments: \"name\", optional \"args\", and optional \"options\"");break}}let a={};return r.noRet&&(a.noRet=1),promiseTimeout(_callClient(e,t,n,a),r.timeout)}function _callBrowser(e,t,n,r={}){return e&&e.valid?(requireNamespace(),new Promise(a=>{const o=uid();r.noRet||(rpcPending[o]={resolve:a}),sendEvent({type:EventType.REQUEST,id:o,name:t,env:environment,...r},n,t=>e.emit(getEventName(PROCESS_EVENT),t),!1)})):Promise.reject("INVALID_BROWSER")}function _callBrowsers(e,t,n,r={}){switch(requireNamespace(),environment){case"client":const a=rpcBrowserProcedures[t];return a&&a.valid?_callBrowser(a,t,n,r):Promise.reject(ERR_NOT_FOUND);case"server":return _callClient(e,"__rpc:callBrowsers",[t,n,+r.noRet],r);case"cef":return _callClient(null,"__rpc:callBrowsers",[t,n,+r.noRet],r);}}function callBrowsers(e,t,n,r={}){requireNamespace();let a,o={};switch(environment){case"client":case"cef":if(r=n||{},n=t,t=e,1>arguments.length||3<arguments.length)return Promise.reject("callBrowsers from the client or browser expects 1 to 3 arguments: \"name\", optional \"args\", and optional \"options\"");r.noRet&&(o.noRet=1),a=_callBrowsers(null,t,n,o);break;case"server":if(2>arguments.length||4<arguments.length)return Promise.reject("callBrowsers from the server expects 2 to 4 arguments: \"player\", \"name\", optional \"args\", and optional \"options\"");r.noRet&&(o.noRet=1),a=_callBrowsers(e,t,n,o);}if(a)return promiseTimeout(a,r.timeout)}function callBrowser(e,t,n,r={}){if("client"!==environment)return Promise.reject("callBrowser can only be used in the client environment");if(2>arguments.length||4<arguments.length)return Promise.reject("callBrowser expects 2 to 4 arguments: \"browser\", \"name\", optional \"args\", and optional \"options\"");requireNamespace();let a={};return r.noRet&&(a.noRet=1),promiseTimeout(_callBrowser(e,t,n,a),r.timeout)}function callEvent(e,t,n){const r=rpcEvListeners[e];r&&r.forEach(e=>e(t,n))}function on(e,t){if(2!==arguments.length)throw"on expects 2 arguments: \"name\" and \"cb\"";const n=rpcEvListeners[e]||new Set;n.add(t),rpcEvListeners[e]=n}function off(e,t){if(2!==arguments.length)throw"off expects 2 arguments: \"name\" and \"cb\"";const n=rpcEvListeners[e];n&&n.delete(t)}function trigger(e,t){if(1>arguments.length||2<arguments.length)throw"trigger expects 1 or 2 arguments: \"name\", and optional \"args\"";callEvent(e,t,{environment})}function triggerClient(e,t,n){switch(requireNamespace(),environment){case"client":{if(n=t,t=e,e=null,1>arguments.length||2<arguments.length||"string"!=typeof t)throw"triggerClient from the client expects 1 or 2 arguments: \"name\", and optional \"args\"";break}case"server":{if(2>arguments.length||3<arguments.length||"object"!=typeof e)throw"triggerClient from the server expects 2 or 3 arguments: \"player\", \"name\", and optional \"args\"";break}case"cef":{if(n=t,t=e,e=null,1>arguments.length||2<arguments.length||"string"!=typeof t)throw"triggerClient from the browser expects 1 or 2 arguments: \"name\", and optional \"args\"";break}}_callClient(e,getEventName(TRIGGER_EVENT),[t,n],{noRet:1})}function triggerServer(e,t){if(1>arguments.length||2<arguments.length)throw"triggerServer expects 1 or 2 arguments: \"name\", and optional \"args\"";requireNamespace(),_callServer(getEventName(TRIGGER_EVENT),[e,t],{noRet:1})}function triggerBrowsers(e,t,n){switch(environment){case"client":case"cef":if(n=t,t=e,e=null,1>arguments.length||2<arguments.length)throw"triggerBrowsers from the client or browser expects 1 or 2 arguments: \"name\", and optional \"args\"";break;case"server":if(2>arguments.length||3<arguments.length)throw"triggerBrowsers from the server expects 2 or 3 arguments: \"player\", \"name\", and optional \"args\"";}requireNamespace(),_callClient(e,getEventName(TRIGGER_EVENT_BROWSERS),[t,n],{noRet:1})}function triggerBrowser(e,t,n){if("client"!==environment)throw"callBrowser can only be used in the client environment";if(2>arguments.length||4<arguments.length)throw"callBrowser expects 2 or 3 arguments: \"browser\", \"name\", and optional \"args\"";requireNamespace(),_callBrowser(e,getEventName(TRIGGER_EVENT),[t,n],{noRet:1})}const procedurable=()=>function(e){return class extends e{constructor(...t){if(super(...t),!Reflect.getMetadata("design:procedurelist:init",e.prototype)){const t=Reflect.getMetadata("design:procedurelist",e.prototype)||[];t.forEach((e,t)=>{e=e.map(e=>{const{procedure:n,callable:r}=e,a=this[r].bind(this);if("function"!=typeof this[r])throw new Error(`Event[${t}] in ${this.constructor.name} is not callable!`);return n.forEach(e=>register(e,a)),e.func=a,e});const n=registeredProcedures.get(t)||[];registeredProcedures.set(t,[...n,...e])}),Reflect.defineMetadata("design:procedurelist:init",!0,e.prototype)}}}},procedure=e=>{e=Array.isArray(e)?e:[e];const t=e.filter((t,n)=>e.indexOf(t)===n),n={procedure:t,callable:""},r=t[0];return function(e,t,a){if(!(a.value instanceof Function))throw new Error(`Procedure[${r}] must be callable`);const o=Reflect.getMetadata("design:procedurelist",e)||new Map;n.callable=t.toString();const l=o.get(r);return o.set(r,l&&[...l,n]||[n]),Reflect.defineMetadata("design:procedurelist",o,e),a}};var index={init,addWebView,register,unregister,call,callServer,callClient,callBrowsers,callBrowser,on,off,trigger,triggerServer,triggerClient,triggerBrowsers,triggerBrowser,procedurable,procedure};exports.addWebView=addWebView,exports.call=call,exports.callBrowser=callBrowser,exports.callBrowsers=callBrowsers,exports.callClient=callClient,exports.callServer=callServer,exports.default=index,exports.init=init,exports.off=off,exports.on=on,exports.procedurable=procedurable,exports.procedure=procedure,exports.register=register,exports.trigger=trigger,exports.triggerBrowser=triggerBrowser,exports.triggerBrowsers=triggerBrowsers,exports.triggerClient=triggerClient,exports.triggerServer=triggerServer,exports.unregister=unregister;
